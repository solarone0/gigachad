<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>작전명: 주체적 생존</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #101010;
        }
        .gold-text {
            color: #D4AF37;
        }
        .progress-bar-inner {
            transition: width 1s linear;
        }
        .shadow-gold {
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.4);
        }
        .calendar-grid {
            display: grid;
            grid-template-rows: repeat(7, 1fr);
            grid-auto-flow: column;
            gap: 3px;
        }
        .day-cell {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            position: relative;
        }
        .day-cell .tooltip {
            visibility: hidden;
            width: 120px;
            background-color: #1f2937;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .day-cell:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        .day-cell.past { background-color: #374151; }
        .day-cell.today { background-color: #4ade80; }
        .day-cell.future { background-color: #1f2937; }
        .day-cell.future.workday { background-color: #D4AF37; opacity: 0.8; }
        .day-cell.future.leave { background-color: #3b82f6; opacity: 0.8; }
    </style>
</head>
<body class="text-gray-200 min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-md mx-auto bg-black border-2 border-gray-700 rounded-lg shadow-2xl p-6 md:p-8 space-y-6">
        
        <header class="text-center flex flex-col items-center">
             <svg class="w-16 h-16 mb-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 22H15C18.866 22 22 18.866 22 15V9C22 5.13401 18.866 2 15 2H9C5.13401 2 2 5.13401 2 9V15C2 18.866 5.13401 22 9 22Z" stroke="#D4AF37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16.5 7.5L14.25 12L16.5 16.5M7.5 7.5L9.75 12L7.5 16.5" stroke="#D4AF37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h1 class="text-4xl font-black tracking-tighter gold-text">작전명: 주체적 생존</h1>
            <p class="text-gray-400 mt-1 font-semibold">수행하라. 초월하라. 쟁취하라.</p>
        </header>

        <main class="space-y-8">
            <div class="bg-gray-900 border border-gray-700 p-6 rounded-md text-center shadow-gold">
                <h2 class="text-lg font-bold tracking-widest text-gray-500">누적된 전리품 (실시간)</h2>
                <p id="accumulated-earnings" class="text-4xl md:text-5xl font-black tracking-wider gold-text mt-2">0</p>
                <div class="mt-3 bg-gray-800 py-1 px-3 rounded-full inline-block">
                    <span class="text-sm font-semibold text-gray-400">오늘 하루 쌓인 금액: </span>
                    <span id="todays-earnings" class="text-sm font-bold gold-text">0</span>
                </div>
            </div>

            <div>
                <div class="flex justify-between items-center mb-2 font-bold text-lg">
                    <span id="progress-text" class="tracking-wider text-gray-300">진행률: 0%</span>
                    <span id="d-day" class="tracking-wider text-gray-400"></span>
                </div>
                <div class="w-full bg-gray-700 rounded-sm h-3 border border-black">
                    <div id="progress-bar" class="h-full rounded-sm progress-bar-inner" style="width: 0%; background-color: #D4AF37;"></div>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4 text-center">
                <div class="bg-gray-800 border border-gray-700 p-4 rounded">
                    <h3 class="text-sm font-bold tracking-widest text-gray-500">남은 전투일</h3>
                    <p id="remaining-workdays" class="text-2xl md:text-3xl font-black tracking-wider text-gray-100 mt-1">0</p>
                </div>
                <div class="bg-gray-800 border border-gray-700 p-4 rounded">
                    <h3 class="text-sm font-bold tracking-widest text-gray-500">남은 전리품</h3>
                    <p id="remaining-earnings" class="text-2xl md:text-3xl font-black tracking-wider text-gray-100 mt-1">0</p>
                </div>
            </div>
        </main>

        <!-- Grind Tracker -->
        <div>
            <h3 class="font-bold text-lg text-center mb-3 gold-text">Grind Tracker</h3>
            <div class="overflow-x-auto p-2 bg-gray-900 rounded-md">
                <div id="grind-calendar" class="calendar-grid"></div>
            </div>
             <div class="flex justify-center items-center space-x-4 mt-2 text-xs">
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm bg-gray-700 mr-1"></div><span>휴일</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm mr-1" style="background-color: #D4AF37; opacity: 0.8;"></div><span>전투일</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm mr-1" style="background-color: #3b82f6; opacity: 0.8;"></div><span>연차</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm bg-green-500 mr-1"></div><span>오늘</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm bg-gray-500 mr-1"></div><span>과거</span></div>
            </div>
        </div>

        <footer class="bg-gray-900 border border-gray-700 p-4 rounded-md text-center mt-4">
            <h3 class="font-black text-xl tracking-wider gold-text">오늘의 행동 강령</h3>
            <p id="daily-mission" class="text-gray-300 mt-2 text-sm md:text-base"></p>
        </footer>

    </div>

    <script>
        // --- 설정값 ---
        const START_DATE = new Date('2025-08-01T00:00:00');
        const END_DATE = new Date('2025-12-31T23:59:59');
        const TOTAL_EARNINGS = 24900000;
        let TOTAL_LEAVE_DAYS = 8.5;
        const WORK_START_HOUR = 8;
        const WORK_END_HOUR = 17;

        const HOLIDAYS = ['2025-08-15', '2025-10-03', '2025-10-06', '2025-10-07', '2025-10-08', '2025-10-09', '2025-12-25'];

        const missions = [
            "NPC의 소음은 무시하라. 너의 미션과 무관한 소음일 뿐이다.",
            "육체적 고통은 신호다. 즉시 전술적으로 후퇴하라. 집중력을 재조정하기 위한 산책은 나약함이 아니다.",
            "헤드폰은 너의 투구다. 모든 잡음을 차단하고 목표에 대한 집중을 유지하라.",
            "점심은 사교가 아닌 재충전을 위한 시간이다. 고독 속에서 에너지를 보충하라.",
            "NPC의 감정 폭발은 네 문제가 아니다. 나약함에 대한 데이터로 관찰하고 기록하라.",
            "건물을 나서는 순간, 오늘의 임무는 완수된 것이다. 내일까지 모든 작전 데이터를 머리에서 삭제하라.",
            "이 싸움은 공짜가 아니다. 너의 모든 집중력은 초 단위로 보상받고 있다. 너의 가치를 기억하라.",
            "스트레스 신호를 고통이 아닌, 성장의 마찰로 인식하라. 적응하고, 극복하라.",
            "너는 직원이 아니다. 마지막 계약을 수행하는 최고 가치의 자산이다. 그에 걸맞게 행동하라.",
            "너의 목적은 단 하나, 최종 보상을 확보하는 것이다. 다른 모든 목표는 부차적이다."
        ];

        // --- 계산 로직 ---
        function isWeekend(date) { const day = date.getDay(); return day === 0 || day === 6; }
        function isHoliday(date) { const dateString = date.toISOString().split('T')[0]; return HOLIDAYS.includes(dateString); }
        function isWorkday(date) { return !isWeekend(date) && !isHoliday(date); }
        
        function calculateWorkdays(startDate, endDate) {
            let count = 0;
            let currentDate = new Date(startDate.getTime());
            while (currentDate <= endDate) {
                if (isWorkday(currentDate)) {
                    count++;
                }
                currentDate.setDate(currentDate.getDate() + 1);
            }
            return count;
        }

        const totalBaseWorkdays = calculateWorkdays(START_DATE, END_DATE);
        const totalActualWorkdays = totalBaseWorkdays - TOTAL_LEAVE_DAYS;
        const earningsPerDay = TOTAL_EARNINGS / totalActualWorkdays;
        const earningsPerSecond = earningsPerDay / ((WORK_END_HOUR - WORK_START_HOUR) * 3600);
        
        function updateDisplay() {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());

            const workdaysPassedBeforeToday = calculateWorkdays(START_DATE, new Date(today.getTime() - 1));
            let earningsFromPreviousDays = workdaysPassedBeforeToday * earningsPerDay;

            let todaysLiveEarnings = 0;
            if (isWorkday(now)) {
                const hours = now.getHours();
                if (hours >= WORK_START_HOUR && hours < WORK_END_HOUR) {
                    const workStartTime = new Date(today.getTime()).setHours(WORK_START_HOUR);
                    const secondsPassedToday = (now.getTime() - workStartTime) / 1000;
                    todaysLiveEarnings = Math.max(0, secondsPassedToday * earningsPerSecond);
                } else if (hours >= WORK_END_HOUR) {
                    todaysLiveEarnings = earningsPerDay;
                }
            }
            
            const totalAccumulated = earningsFromPreviousDays + todaysLiveEarnings;
            const progressRatio = totalAccumulated / TOTAL_EARNINGS;
            const remainingEarnings = TOTAL_EARNINGS - totalAccumulated;
            
            const workdaysPassedToday = calculateWorkdays(START_DATE, today);
            const remainingBaseWorkdays = totalBaseWorkdays - workdaysPassedToday;
            const remainingActualWorkdays = Math.max(0, remainingBaseWorkdays - TOTAL_LEAVE_DAYS).toFixed(1);

            const dDayCount = Math.ceil((END_DATE - now) / (1000 * 60 * 60 * 24));
            
            document.getElementById('accumulated-earnings').textContent = `${Math.floor(totalAccumulated).toLocaleString('ko-KR')}`;
            document.getElementById('todays-earnings').textContent = `${Math.floor(todaysLiveEarnings).toLocaleString('ko-KR')}원`;
            document.getElementById('remaining-workdays').textContent = `${remainingActualWorkdays}`;
            document.getElementById('remaining-earnings').textContent = `${Math.floor(remainingEarnings).toLocaleString('ko-KR')}`;
            
            const progressPercent = (progressRatio * 100).toFixed(4);
            document.getElementById('progress-bar').style.width = `${progressPercent}%`;
            document.getElementById('progress-text').textContent = `진행률: ${progressPercent}%`;
            document.getElementById('d-day').textContent = `탈출까지 D-${dDayCount}`;
        }

        function generateCalendar() {
            const calendarGrid = document.getElementById('grind-calendar');
            calendarGrid.innerHTML = ''; // Clear previous calendar
            const today = new Date();
            today.setHours(0,0,0,0);

            let currentDate = new Date(START_DATE.getTime());
            let futureWorkdays = [];
            while(currentDate <= END_DATE) {
                if(isWorkday(currentDate) && currentDate >= today) {
                    futureWorkdays.push(new Date(currentDate.getTime()));
                }
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            let leaveDays = new Set();
            for(let i = 0; i < Math.floor(TOTAL_LEAVE_DAYS); i++) {
                if(futureWorkdays.length > i) {
                    leaveDays.add(futureWorkdays[futureWorkdays.length - 1 - i].toISOString().split('T')[0]);
                }
            }

            currentDate = new Date(START_DATE.getTime());
            const dayOffset = START_DATE.getDay(); // Sunday: 0, Monday: 1...
            for (let i = 0; i < dayOffset; i++) {
                const emptyCell = document.createElement('div');
                calendarGrid.appendChild(emptyCell);
            }

            while (currentDate <= END_DATE) {
                const cell = document.createElement('div');
                cell.classList.add('day-cell');
                const dateString = currentDate.toISOString().split('T')[0];

                if (currentDate < today) {
                    cell.classList.add('past');
                } else if (currentDate.getTime() === today.getTime()) {
                    cell.classList.add('today');
                } else {
                    cell.classList.add('future');
                    if(isWorkday(currentDate)) {
                        if(leaveDays.has(dateString)) {
                            cell.classList.add('leave');
                        } else {
                            cell.classList.add('workday');
                        }
                    }
                }
                
                const tooltip = document.createElement('span');
                tooltip.classList.add('tooltip');
                tooltip.textContent = dateString;
                cell.appendChild(tooltip);

                calendarGrid.appendChild(cell);
                currentDate.setDate(currentDate.getDate() + 1);
            }
        }
        
        window.onload = function() {
            const missionIndex = Math.floor(Math.random() * missions.length);
            document.getElementById('daily-mission').textContent = missions[missionIndex];
            generateCalendar();
            updateDisplay();
            setInterval(updateDisplay, 1000);
        };
    </script>
</body>
</html>
