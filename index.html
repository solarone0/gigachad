<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operation: Sovereign Grind</title>
    
    <!-- PWA & Homescreen Icon Configuration -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="S.Grind">
    <meta name="application-name" content="S.Grind">
    <meta name="theme-color" content="#101010">

    <!-- Icon generated as a Data URI to keep everything in one file -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23101010'/%3E%3Cpath d='M25 25 L75 75 M25 75 L75 25' stroke='%23D4AF37' stroke-width='12' stroke-linecap='round'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23101010'/%3E%3Cpath d='M25 25 L75 75 M25 75 L75 25' stroke='%23D4AF37' stroke-width='12' stroke-linecap='round'/%3E%3C/svg%3E">

    <!-- Web App Manifest generated as a Data URI -->
    <link rel="manifest" href="data:application/manifest+json,{
        &quot;name&quot;: &quot;Operation: Sovereign Grind&quot;,
        &quot;short_name&quot;: &quot;S.Grind&quot;,
        &quot;start_url&quot;: &quot;.&quot;,
        &quot;display&quot;: &quot;standalone&quot;,
        &quot;background_color&quot;: &quot;%23101010&quot;,
        &quot;theme_color&quot;: &quot;%23D4AF37&quot;,
        &quot;icons&quot;: [
            {
                &quot;src&quot;: &quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23101010'/%3E%3Cpath d='M25 25 L75 75 M25 75 L75 25' stroke='%23D4AF37' stroke-width='12' stroke-linecap='round'/%3E%3C/svg%3E&quot;,
                &quot;sizes&quot;: &quot;192x192&quot;,
                &quot;type&quot;: &quot;image/svg+xml&quot;
            },
            {
                &quot;src&quot;: &quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%23101010'/%3E%3Cpath d='M25 25 L75 75 M25 75 L75 25' stroke='%23D4AF37' stroke-width='12' stroke-linecap='round'/%3E%3C/svg%3E&quot;,
                &quot;sizes&quot;: &quot;512x512&quot;,
                &quot;type&quot;: &quot;image/svg+xml&quot;
            }
        ]
    }">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #101010;
        }
        .gold-text { color: #D4AF37; }
        .progress-bar-inner { transition: width 1s linear; }
        .shadow-gold { box-shadow: 0 0 15px rgba(212, 175, 55, 0.4); }
        .calendar-grid {
            display: grid;
            grid-template-rows: repeat(7, 1fr);
            grid-auto-flow: column;
            gap: 2px;
        }
        .day-cell {
            width: 10px; height: 10px;
            border-radius: 2px; position: relative;
        }
        .day-cell .tooltip {
            visibility: hidden; width: 120px;
            background-color: #1f2937; color: #fff;
            text-align: center; border-radius: 6px;
            padding: 5px 0; position: absolute;
            z-index: 1; bottom: 125%; left: 50%;
            margin-left: -60px; opacity: 0;
            transition: opacity 0.3s;
        }
        .day-cell:hover .tooltip { visibility: visible; opacity: 1; }
        .day-cell.past { background-color: #374151; }
        .day-cell.today { background-color: #4ade80; }
        .day-cell.future { background-color: #1f2937; }
        .day-cell.future.workday { background-color: #D4AF37; opacity: 0.8; }
        .day-cell.future.leave { background-color: #3b82f6; opacity: 0.8; }
        .tab-button {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .tab-button.active {
            color: #D4AF37;
            border-bottom-color: #D4AF37;
        }
    </style>
</head>
<body class="text-gray-200 min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-md mx-auto bg-black border-2 border-gray-700 rounded-lg shadow-2xl p-6 md:p-8 space-y-6">
        
        <header class="text-center flex flex-col items-center">
             <svg class="w-16 h-16 mb-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 22H15C18.866 22 22 18.866 22 15V9C22 5.13401 18.866 2 15 2H9C5.13401 2 2 5.13401 2 9V15C2 18.866 5.13401 22 9 22Z" stroke="#D4AF37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M16.5 7.5L14.25 12L16.5 16.5M7.5 7.5L9.75 12L7.5 16.5" stroke="#D4AF37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h1 id="operation-title" class="text-4xl font-black tracking-tighter gold-text"></h1>
            <p class="text-gray-400 mt-1 font-semibold">Execute. Ascend. Conquer.</p>
        </header>

        <!-- Scenario Tabs -->
        <div class="flex justify-center border-b border-gray-700">
            <button id="tab-sovereign" class="tab-button active font-bold py-2 px-4">Sovereign Grind (Dec)</button>
            <button id="tab-swift" class="tab-button font-bold py-2 px-4">Swift Exit (Sep)</button>
        </div>

        <main class="space-y-8">
            <div class="bg-gray-900 border border-gray-700 p-6 rounded-md text-center shadow-gold">
                <h2 class="text-lg font-bold tracking-widest text-gray-500">Spoils Accumulated (Live)</h2>
                <p id="accumulated-earnings" class="text-4xl md:text-5xl font-black tracking-wider gold-text mt-2">0</p>
                <div class="mt-3 bg-gray-800 py-1 px-3 rounded-full inline-block">
                    <span class="text-sm font-semibold text-gray-400">Today's Spoils: </span>
                    <span id="todays-earnings" class="text-sm font-bold gold-text">0</span>
                </div>
            </div>

            <div>
                <div class="flex justify-between items-center mb-2 font-bold text-lg">
                    <span id="progress-text" class="tracking-wider text-gray-300">Total Progress: 0%</span>
                    <span id="d-day" class="tracking-wider text-gray-400"></span>
                </div>
                <div class="w-full bg-gray-700 rounded-sm h-3 border border-black">
                    <div id="progress-bar" class="h-full rounded-sm progress-bar-inner" style="width: 0%; background-color: #D4AF37;"></div>
                </div>
                <div class="mt-3">
                    <div class="flex justify-between items-center mb-1 text-xs text-gray-400">
                        <span>Daily Grind (08:00 - 17:00)</span>
                        <span id="daily-progress-text">0%</span>
                    </div>
                    <div class="w-full bg-gray-700 rounded-sm h-2">
                        <div id="daily-progress-bar" class="h-full rounded-sm progress-bar-inner bg-green-500" style="width: 0%;"></div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4 text-center">
                <div class="bg-gray-800 border border-gray-700 p-4 rounded">
                    <h3 class="text-sm font-bold tracking-widest text-gray-500">Grind Days Remaining</h3>
                    <p id="remaining-workdays" class="text-2xl md:text-3xl font-black tracking-wider text-gray-100 mt-1">0</p>
                </div>
                <div class="bg-gray-800 border border-gray-700 p-4 rounded">
                    <h3 class="text-sm font-bold tracking-widest text-gray-500">Spoils Remaining</h3>
                    <p id="remaining-earnings" class="text-xl md:text-2xl font-black tracking-wider text-gray-100 mt-1">0</p>
                </div>
            </div>
        </main>

        <!-- Grind Tracker -->
        <div>
            <h3 class="font-bold text-lg text-center mb-3 gold-text">Grind Tracker</h3>
            <div class="overflow-x-auto p-2 bg-gray-900 rounded-md">
                <div id="grind-calendar" class="calendar-grid"></div>
            </div>
             <div class="flex justify-center items-center space-x-4 mt-2 text-xs">
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm bg-gray-700 mr-1"></div><span>Off-Day</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm mr-1" style="background-color: #D4AF37; opacity: 0.8;"></div><span>Grind</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm mr-1" style="background-color: #3b82f6; opacity: 0.8;"></div><span>Leave</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm bg-green-500 mr-1"></div><span>Today</span></div>
                <div class="flex items-center"><div class="w-3 h-3 rounded-sm bg-gray-500 mr-1"></div><span>Conquered</span></div>
            </div>
        </div>

        <footer class="bg-gray-900 border border-gray-700 p-4 rounded-md text-center">
            <h3 class="font-black text-xl tracking-wider gold-text">Today's Alpha Protocol</h3>
            <p id="daily-mission" class="text-gray-300 mt-2 text-sm md:text-base"></p>
        </footer>

    </div>

    <script>
        const scenarios = {
            sovereign: {
                title: "Operation: Sovereign Grind",
                startDate: new Date('2025-08-01T00:00:00'),
                endDate: new Date('2025-12-31T23:59:59'),
                totalEarnings: 24900000,
                totalLeaveDays: 8.5,
            },
            swift: {
                title: "Operation: Swift Exit",
                startDate: new Date('2025-08-01T00:00:00'),
                endDate: new Date('2025-09-30T23:59:59'),
                totalEarnings: 3940000 * 2,
                totalLeaveDays: 5.5,
            }
        };

        let currentScenario;
        let intervalId;

        const HOLIDAYS = ['2025-08-15', '2025-10-03', '2025-10-06', '2025-10-07', '2025-10-08', '2025-10-09', '2025-12-25'];
        const missions = [
            "Engage NPC chatter with stoic indifference. Their noise is irrelevant to your mission.",
            "Physical distress is a signal. Execute a tactical retreat. A walk to recalibrate focus. Weakness is not an option.",
            "Headphones are your helmet. Block out the static. Maintain unwavering focus on the objective.",
            "The midday meal is for refueling, not for beta socialization. Consume it alone. Recharge in solitude.",
            "An NPC's emotional outburst is not your problem. Observe it as data. A case study in weakness.",
            "The moment you exit the building, the mission for the day is complete. Purge all operational data from your mind until tomorrow.",
            "This grind is not free. You are being paid handsomely for every second of your focus. Remember your worth.",
            "Acknowledge physical signals of stress not as pain, but as the friction of progress. Adapt and overcome.",
            "You are not an employee. You are a high-value asset executing a final contract. Act accordingly.",
            "Your purpose here is singular: secure the final payout. All other objectives are secondary."
        ];

        function isWeekend(date) { const day = date.getDay(); return day === 0 || day === 6; }
        function isHoliday(date) { const dateString = date.toISOString().split('T')[0]; return HOLIDAYS.includes(dateString); }
        function isWorkday(date) { return !isWeekend(date) && !isHoliday(date); }
        
        function calculateWorkdays(startDate, endDate) {
            let count = 0;
            let currentDate = new Date(startDate.getTime());
            while (currentDate <= endDate) {
                if (isWorkday(currentDate)) {
                    count++;
                }
                currentDate.setDate(currentDate.getDate() + 1);
            }
            return count;
        }

        function updateDisplay() {
            const { startDate, endDate, totalEarnings, totalLeaveDays } = currentScenario;
            const WORK_START_HOUR = 8;
            const WORK_END_HOUR = 17;

            const totalBaseWorkdays = calculateWorkdays(startDate, endDate);
            const totalActualWorkdays = totalBaseWorkdays - totalLeaveDays;
            const earningsPerDay = totalEarnings / totalActualWorkdays;
            const earningsPerSecond = earningsPerDay / ((WORK_END_HOUR - WORK_START_HOUR) * 3600);
            
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());

            const workdaysPassedBeforeToday = calculateWorkdays(startDate, new Date(today.getTime() - 1));
            let earningsFromPreviousDays = workdaysPassedBeforeToday * earningsPerDay;

            let todaysLiveEarnings = 0;
            let dailyProgressPercent = 0;

            if (isWorkday(now) && now >= startDate && now <= endDate) {
                const hours = now.getHours();
                const workStartTime = new Date(today.getTime()).setHours(WORK_START_HOUR, 0, 0, 0);
                const workEndTime = new Date(today.getTime()).setHours(WORK_END_HOUR, 0, 0, 0);

                if (now.getTime() >= workStartTime && now.getTime() < workEndTime) {
                    const secondsPassedToday = (now.getTime() - workStartTime) / 1000;
                    todaysLiveEarnings = Math.max(0, secondsPassedToday * earningsPerSecond);
                    dailyProgressPercent = (secondsPassedToday / ((WORK_END_HOUR - WORK_START_HOUR) * 3600)) * 100;
                } else if (now.getTime() >= workEndTime) {
                    todaysLiveEarnings = earningsPerDay;
                    dailyProgressPercent = 100;
                }
            }
            
            let totalAccumulated = earningsFromPreviousDays + todaysLiveEarnings;
            totalAccumulated = Math.min(totalAccumulated, totalEarnings);
            
            const progressRatio = totalEarnings > 0 ? totalAccumulated / totalEarnings : 0;
            const remainingEarnings = totalEarnings - totalAccumulated;
            
            const workdaysPassedToday = calculateWorkdays(startDate, today);
            const remainingBaseWorkdays = totalBaseWorkdays - workdaysPassedToday;
            const remainingActualWorkdays = Math.max(0, remainingBaseWorkdays - totalLeaveDays).toFixed(1);

            const dDayCount = Math.ceil((endDate - now) / (1000 * 60 * 60 * 24));
            
            document.getElementById('accumulated-earnings').textContent = `${Math.floor(totalAccumulated).toLocaleString('en-US')}`;
            document.getElementById('todays-earnings').textContent = `${Math.floor(todaysLiveEarnings).toLocaleString('en-US')}`;
            document.getElementById('remaining-workdays').textContent = `${remainingActualWorkdays}`;
            document.getElementById('remaining-earnings').textContent = `${Math.floor(remainingEarnings).toLocaleString('en-US')}`;
            
            const progressPercent = (progressRatio * 100).toFixed(4);
            document.getElementById('progress-bar').style.width = `${progressPercent}%`;
            document.getElementById('progress-text').textContent = `Total Progress: ${progressPercent}%`;
            document.getElementById('d-day').textContent = `Exodus: D-${dDayCount}`;

            document.getElementById('daily-progress-bar').style.width = `${dailyProgressPercent}%`;
            document.getElementById('daily-progress-text').textContent = `${Math.floor(dailyProgressPercent)}%`;
        }

        function generateCalendar() {
            const { startDate, endDate, totalLeaveDays } = currentScenario;
            const calendarGrid = document.getElementById('grind-calendar');
            calendarGrid.innerHTML = '';
            const today = new Date();
            today.setHours(0,0,0,0);

            let currentDate = new Date(startDate.getTime());
            let futureWorkdays = [];
            while(currentDate <= endDate) {
                if(isWorkday(currentDate) && currentDate >= today) {
                    futureWorkdays.push(new Date(currentDate.getTime()));
                }
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            let leaveDays = new Set();
            for(let i = 0; i < Math.floor(totalLeaveDays); i++) {
                if(futureWorkdays.length > i) {
                    leaveDays.add(futureWorkdays[futureWorkdays.length - 1 - i].toISOString().split('T')[0]);
                }
            }

            currentDate = new Date(startDate.getTime());
            const dayMap = [6, 0, 1, 2, 3, 4, 5];
            const dayOffset = dayMap[startDate.getDay()];
            for (let i = 0; i < dayOffset; i++) {
                calendarGrid.appendChild(document.createElement('div'));
            }

            while (currentDate <= endDate) {
                const cell = document.createElement('div');
                cell.classList.add('day-cell');
                const dateString = currentDate.toISOString().split('T')[0];

                if (currentDate < today) {
                    cell.classList.add('past');
                } else if (currentDate.getTime() === today.getTime()) {
                    cell.classList.add('today');
                } else {
                    cell.classList.add('future');
                    if(isWorkday(currentDate)) {
                        if(leaveDays.has(dateString)) {
                            cell.classList.add('leave');
                        } else {
                            cell.classList.add('workday');
                        }
                    }
                }
                
                const tooltip = document.createElement('span');
                tooltip.classList.add('tooltip');
                tooltip.textContent = dateString;
                cell.appendChild(tooltip);

                calendarGrid.appendChild(cell);
                currentDate.setDate(currentDate.getDate() + 1);
            }
        }
        
        function initialize(scenarioKey) {
            currentScenario = scenarios[scenarioKey];
            document.getElementById('operation-title').textContent = currentScenario.title;
            
            document.getElementById('tab-sovereign').classList.toggle('active', scenarioKey === 'sovereign');
            document.getElementById('tab-swift').classList.toggle('active', scenarioKey === 'swift');

            if (intervalId) clearInterval(intervalId);
            generateCalendar();
            updateDisplay();
            intervalId = setInterval(updateDisplay, 1000);
        }

        window.onload = function() {
            const missionIndex = Math.floor(Math.random() * missions.length);
            document.getElementById('daily-mission').textContent = missions[missionIndex];
            
            document.getElementById('tab-sovereign').addEventListener('click', () => initialize('sovereign'));
            document.getElementById('tab-swift').addEventListener('click', () => initialize('swift'));

            initialize('sovereign'); // Default scenario
        };
    </script>
</body>
</html>